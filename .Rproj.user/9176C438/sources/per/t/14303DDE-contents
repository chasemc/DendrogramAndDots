---
title: "Dendrogram and Dots: Figuring it Out"
author: "Chase Clark"
date: "January 4, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


Load dendrogram cached file for testing with:
```{r}
library("tidyverse")
library("dendextend")

dend<-readRDS("Data/Distance-cosineD_Clustering-ward.D2_UsedPresenceAbsence_SNR-4_PercentPresence-70_LowCut-3000_HighCut-15000.rds")

dend<-dend %>% set("labels_color", "white")

```

Read csv of groups
```{r}
groupFile<-read_csv("data/b.csv")
```

Load colored_Dots.R function
```{r,include=FALSE}
source('~/Documents/GitHub/DendrogramAndDots/R/colored_Dots.R', echo=TRUE)
```


need to simulate input


```{r}
input<-as_tibble(t(names(groupFile))) 
names(input)<-names(groupFile)
input$`Media type`


```

```{r}

dendrogramLabels<-as_tibble(labels(dend))
names(dendrogramLabels)<-'Sample name'
joinedData<-left_join(dendrogramLabels,groupFile,by="Sample name")

naReplaceValues<-as.list(sapply(names(joinedData),function(x)paste0("Missing ",x)))

joinedData<-joinedData %>%  replace_na(replace=naReplaceValues)


small<-joinedData[,c(1,3)]
w<-small %>% group_by(`Sample type 1`)

ohShitList<-split(small,factor(small$`Sample type 1`))

bigShit<-lapply(1:length(ohShitList),function(x)left_join(dendrogramLabels,ohShitList[[x]],by='Sample name'))

labels(bigShit)<-labels(ohShitList)




for(x in 1:length(bigShit)){
    bigShit[[x]]$`Sample type 1`[!is.na(bigShit[[x]]$`Sample type 1`)]<-"#000000"
    bigShit[[x]]$`Sample type 1`[is.na(bigShit[[x]]$`Sample type 1`)]<-"#00000000"
}



```

Now we we have a list. Each list item represents a group/column from excel table.
These are associated to the entire dendrogram, by label and are in the same order as the dendrogram from top to bottom.
0 means a label is not part of the group, 1 means it is part of the group


#000000  is black
#00000000 is black but transparent   in case we want color supprt later




```{r}


par(mar = c(8,8,8,25))
plot(dend,horiz=T)


colored_dots(cbind(bigShit$algae$`Sample type 1`), dend,
             rowLabels = c("3 clusters", "2 clusters", "Odd numbers"),horiz=T) 





```






